import React from 'react'
import Playground from '@/components/Playground'
import FilesListUpload from './FilesListUpload'
import FilesListUploadRaw from './FilesListUpload.tsx?raw'
import FilesListUploadTree from './FilesListUploadTree'
import FilesListUploadTreeRaw from './FilesListUploadTree.tsx?raw'

# FilesUploadDrawer

FilesUploadDrawer 组件用于展示上传多个文件/文件夹的抽屉，因为涉及到上传文件/文件夹的操作，所以使用此组件的时候需要手动处理上传文件和上传文件夹（如果不需要文件夹，则需要手动过滤文件夹或者使用 `FilesSelect` 组件设置 `isIgnoreFolder` 为 `true`）的函数逻辑。

当父文件夹上传失败的时候，内部的子文件/文件夹直接上传失败。

## 目录

## API

### 参数 Props

``` ts
export type FileType = 'file' | 'folder'
export type FileItemType = {
  type: FileType
  file?: File
  name: string
  size?: number
  filePath: string
  folderPath: string
}

export type FileTreeFileItem = Omit<FileItemType, 'type'> & {
  type: 'file'
}

export type FolderItemType = {
  type: 'folder'
  name: string
  filePath: string
  folderPath: string
  children: FileTreeItem[]
}
export type FileTreeItem = FileTreeFileItem | FolderItemType

export type TargetType = 'tree' | 'list'
```

``` ts
export type UploadFileItemType = FileItemType & {
  icon: React.ReactNode,
  percent: number,
  percentStatus: ProgressProps['status'],
}

export type UploadResultFIleItemType = Omit<FileItemType, 'filePath' | 'folderPath'>

export type UploadResultFileTreeItemType = UploadResultFIleItemType & {
  children?: UploadResultFileTreeItemType[]
}

export type FilesUploadDrawerProps<T extends TargetType> = {
  targetType: T,
  title?: string,
  open: boolean,
  setOpen: (open: boolean) => void,
  list?: FileItemType[],
  locale?: LocaleType,
  onSuccess?: (fileTrees: T extends 'list' ? UploadFileItemType[] : UploadResultFileTreeItemType[]) => void,
}
```

| 属性 | 说明 | 类型 | 默认值 |
| --- | --- | --- | --- |
| targetType | 上传成功回调函数的参数类型 | `'tree' \| 'list'` | - |
| title | 抽屉标题 | `string` | '上传文件/文件夹' |
| open | 是否打开抽屉 | `boolean` | `false` |
| setOpen | 打开/关闭抽屉的回调函数 | `(open: boolean) => void` | - |
| list | 上传文件/文件夹列表 | `FileItemType[]` | [] |
| locale | 语言 | `'zh' \| 'en'` | `'zh'` |
| onSuccess | 上传成功回调函数 | `(fileTrees: T extends 'list' ? UploadFileItemType[] : UploadResultFileTreeItemType[]) => void` | - |

## 演示示例

### 上传文件/文件夹

<Playground code={FilesListUploadRaw} title='上传文件/文件夹' description='选择之后直接上传文件/文件夹，上传成功之后返回文件/文件夹的列表结构。'>
  <FilesListUpload />
</Playground>

### 上传文件/文件夹（树结构）

<Playground code={FilesListUploadTreeRaw} title='上传文件/文件夹（树结构）' description='选择之后直接上传文件/文件夹，上传成功之后返回文件/文件夹的树结构。'>
  <FilesListUploadTree />
</Playground>
